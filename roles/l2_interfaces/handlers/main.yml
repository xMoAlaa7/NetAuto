- name: trunk
  cisco.ios.ios_l2_interfaces:
    config:
      - name: "{{ item.key }}"
        mode: trunk
        trunk:
          allowed_vlans: "{{ item.value.allowed_vlans }}"
          encapsulation: dot1q
    state: merged
  loop: "{{ trunk_interfaces | dict2items }}"
  register: trunk_conf

- name: access
  cisco.ios.ios_l2_interfaces:
    config:
      - name: "{{ item.key }}"
        mode: access
        access:
          vlan: "{{ item.value.vlan }}"
    state: merged
  loop: "{{ access_interfaces | dict2items }}"
  register: access_conf
